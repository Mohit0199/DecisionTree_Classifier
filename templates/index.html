<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Decision Tree Classifier</title>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            padding-top: 20px;
        }
        h1, h2 {
            color: #6dd4ee;
        }
        .lead {
            color: #d2dad8;
        }
        .generate-dataset, .run-algorithm, .classified-plot, .accuracy-report, .decision-tree, .dataset-info, .algorithm-info {
            background-color: #1e1e1e;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            color: #e0e0e0;
        }
        .btn-primary {
            background-color: #538392;
            border-color: #538392;
            color: #ffffff; 
        }
        .btn-primary:hover {
            background-color: #80b9ad;
            border-color: #80b9ad;
        }
        input, select {
            background-color: #2a2a2a;
            color: #e0e0e0;
            border: 1px solid #616161;
        }
        input::placeholder {
            color: #9e9e9e;
        }
        input:focus, select:focus {
            border-color: #b3e2a7;
            outline: none;
            box-shadow: 0 0 4px rgba(179, 226, 167, 0.5); 
        }
        label {
            color: #e0e0e0;
        }
        pre {
            background-color: #333;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>

</head>

<body>
    <div class="container-fluid grid-container">
        <h1 class="text-center my-4">Decision Tree Classifier</h1>
        <p class="text-center lead">
            Welcome to the Decision Tree Classifier! Here, you can generate and visualize datasets, 
            adjust hyperparameters, and run the decision tree model. Start by selecting the number of samples 
            and clusters to create a dataset. The default dataset consists of 800 samples and 1 cluster per class.
            Tune the hyperparameters to see how they affect the model's performance.
        </p>

        <!-- First Row -->
        <div class="row mt-4">
            <!-- Generate Dataset Column -->
            <div class="col-md-12">
                <div class="generate-dataset">
                    <h2>Generate Dataset</h2>
                    <form action="/generate_dataset" method="POST">
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="n_samples">Number of Samples:</label>
                                <input type="number" id="n_samples" name="n_samples" value="{{ n_samples }}" class="form-control">
                            </div>
                            <div class="form-group col-md-4">
                                <label for="n_clusters_per_class">Number of Clusters per Class:</label>
                                <input type="number" id="n_clusters_per_class" name="n_clusters_per_class" value="{{ n_clusters_per_class }}" class="form-control">
                            </div>
                            <div class="form-group col-md-4 align-self-end">
                                <button type="submit" class="btn btn-primary">Generate Dataset</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Second Row -->
        <div class="row mt-4">
            <!-- Scatter Plot -->
            <div class="col-md-9">
                <div class="scatter-plot">
                    {% if error_message %}
                    <p style="color: red;">{{ error_message }}</p>
                    {% endif %}
                    <h2>Scatter Plot of Dataset</h2>
                    <div id="scatter_plot">
                        {{ scatter_plot | safe }}
                    </div>
                </div>
            </div>
            <!-- Dataset Info -->
            <div class="col-md-3">
                <div class="dataset-info">
                    <h2>Dataset Info</h2>
                    <p>Number of Samples: {{ n_samples }}</p>
                    <p>Number of Clusters per Class: {{ n_clusters_per_class }}</p>
                </div>
            </div>
        </div>

        <!-- Third Row -->
        <div class="row mt-4">
            <!-- Run Algorithm -->
            <div class="col-md-12">
                <div class="run-algorithm">
                    <h2>Select Hyperparameters</h2>
                    <form action="/run_model" method="POST">
                        <div class="form-row">
                            <div class="form-group col-md-3">
                                <label for="criterion">Criterion:</label>
                                <select id="criterion" name="criterion" class="form-control">
                                    <option value="gini" selected>gini</option>
                                    <option value="entropy">entropy</option>
                                    <option value="log_loss">log_loss</option>
                                </select>
                            </div>
                            <div class="form-group col-md-3">
                                <label for="splitter">Splitter:</label>
                                <select id="splitter" name="splitter" class="form-control">
                                    <option value="best" selected>best</option>
                                    <option value="random">random</option>
                                </select>
                            </div>
                            <div class="form-group col-md-3">
                                <label for="max_depth">Max Depth:</label>
                                <input type="number" id="max_depth" name="max_depth" class="form-control">
                            </div>
                            <div class="form-group col-md-3">
                                <label for="min_samples_split">Min Samples Split:</label>
                                <input type="number" id="min_samples_split" name="min_samples_split" value="2" class="form-control">
                            </div>
                            <div class="form-group col-md-3">
                                <label for="min_samples_leaf">Min Samples Leaf:</label>
                                <input type="number" id="min_samples_leaf" name="min_samples_leaf" value="1" class="form-control">
                            </div>
                            <div class="form-group col-md-3">
                                <label for="max_features">Max Features:</label>
                                <select id="max_features" name="max_features" class="form-control">
                                    <option value="2" selected>2</option>
                                    <option value="1">1</option>
                                </select>
                            </div>
                            <div class="form-group col-md-3">
                                <label for="max_leaf_nodes">Max Leaf Nodes:</label>
                                <input type="number" id="max_leaf_nodes" name="max_leaf_nodes" class="form-control">
                            </div>
                            <div class="form-group col-md-3">
                                <label for="min_impurity_decrease">Min Impurity Decrease:</label>
                                <input type="number" id="min_impurity_decrease" name="min_impurity_decrease" step="0.01" class="form-control">
                            </div>
                            <div class="form-group col-md-3 align-self-end">
                                <button type="submit" class="btn btn-primary">Run Model</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Fourth Row -->
        <div class="row mt-4">
            <!-- Classified Plot -->
            <div class="col-md-9">
                <div class="classified-plot">
                    <h2>Decision Tree Classification Plot</h2>
                    <div id="classified_plot">
                        {{ classified_plot | safe }}
                    </div>
                </div>
            </div>
            <!-- Hyperparameters Info -->
            <div class="col-md-3">
                <div class="algorithm-info">
                    <h2>Selected Hyperparameters</h2>
                    <p>Criterion: {{ criterion }}</p>
                    <p>Splitter: {{ splitter }}</p>
                    <p>Max Depth: {{ max_depth }}</p>
                    <p>Min Samples Split: {{ min_samples_split }}</p>
                    <p>Min Samples Leaf: {{ min_samples_leaf }}</p>
                    <p>Max Features: {{ max_features }}</p>
                    <p>Max Leaf Nodes: {{ max_leaf_nodes }}</p>
                    <p>Min Impurity Decrease: {{ min_impurity_decrease }}</p>
                </div>
            </div>
        </div>

        <!-- Fifth Row -->
        <div class="row mt-4">
            <!-- Accuracy Report -->
            <div class="col-md-12">
                <div class="accuracy-report">
                    <h2>Accuracy Report</h2>
                    <pre id="classification_report">{{ report | safe }}</pre>
                </div>
            </div>
        </div>

        <!-- Sixth Row -->
        <div class="row mt-4">
            <!-- Decision Tree -->
            <div class="col-md-12">
                <div class="decision-tree">
                    <h2>Decision Tree Visualization</h2>
                    <div id="decision_tree_image">
                        <img src="{{ decision_tree_image }}" alt="Decision Tree Image" class="img-fluid">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-JaA7jmF/7g5z4dcnZv+SFDRpK5FZjZbI5cgP9zlj2Jm3SQQF2F8VfFyShS2N3OaD" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script>
        // Apply a Plotly theme
        var layout = {
            title: 'Decision Tree Scatter Plot',
            plot_bgcolor: '#f8f9fa',
            paper_bgcolor: '#ffffff',
            font: {
                family: 'Roboto, sans-serif',
                size: 14,
                color: '#007bff'
            }
        };
        Plotly.newPlot('scatter_plot', data, layout);
        Plotly.newPlot('classified_plot', data, layout);
    </script>
</body>
</html>
